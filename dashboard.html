<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Space+Grotesk:wght@300;400;500;700&display=swap" rel="stylesheet">
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Dashboard â€” Melodyfy</title>
<script>
(function(){const t=localStorage.getItem('bf_token');if(!t){location.href='index.html';return;}try{const p=JSON.parse(atob(t.split('.')[1]));if(p.exp&&p.exp<Date.now()/1000){localStorage.removeItem('bf_token');location.href='index.html';}}catch(e){localStorage.removeItem('bf_token');location.href='index.html';}})();
</script>
<style>
:root{--bg:#07070a;--bg-canvas:#07070a;--bg-overlay:#0e0e12;--bg-inset:#050508;--border:#2e2e34;--border-muted:#1e1e24;--text-primary:#E8E4DC;--text-secondary:#C9C4BA;--text-muted:#7a7a82;--accent:#EDE8DF;--accent-hover:#F0EDE6;--green-btn:#EDE8DF;--green-hover:#F0EDE6;--green-accent:#EDE8DF;--green-bright:#E8E4DC;--blue:#E8E4DC;--orange:#f0883e;--red:#f87171;--purple:#bc8cff;}
*{margin:0;padding:0;box-sizing:border-box;}html{scroll-behavior:smooth;}
body{background:var(--bg-canvas);color:var(--text-primary);font-family:'Space Grotesk',sans-serif;line-height:1.5;}
h1,h2,h3{font-family:'Archivo Black',sans-serif;color:var(--accent);}


.page{max-width:1200px;margin:0 auto;padding:32px 24px;}
.glass{background:rgba(7,7,10,.7);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid rgba(237,232,223,.4);box-shadow:0 8px 32px rgba(0,0,0,.3),inset 0 1px 0 rgba(237,232,223,.12);border-radius:12px;}
@supports not(backdrop-filter:blur(12px)){.glass{background:#0b0b0f;border:1px solid #4A4A55;}}

.welcome-banner{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px;padding:24px 28px;border-radius:14px;background:var(--bg-overlay);border:1px solid rgba(237,232,223,.18);margin-bottom:28px;}
.welcome-text h1{font-size:1.6rem;margin-bottom:4px;}
.welcome-subtext{font-size:14px;color:var(--text-muted);}
.welcome-actions{display:flex;gap:10px;}

.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:28px;}
.stat-card{background:var(--bg-overlay);border:1px solid var(--border);border-radius:10px;padding:18px 20px;text-align:center;transition:border-color .2s,transform .2s;}
.stat-card:hover{border-color:rgba(237,232,223,.45);transform:translateY(-2px);}
.stat-value{font-family:'Archivo Black',sans-serif;font-size:1.8rem;color:var(--accent);line-height:1.1;margin-bottom:4px;}
.stat-label{font-size:12px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.06em;}

.two-col{display:grid;grid-template-columns:1fr 340px;gap:20px;margin-bottom:28px;}
.section-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;}
.section-title{font-size:15px;font-weight:600;color:var(--text-primary);}
.section-link{font-size:12px;color:var(--accent);text-decoration:none;}
.section-link:hover{text-decoration:underline;}

.project-list{display:flex;flex-direction:column;gap:10px;}
.project-item{display:flex;align-items:center;gap:14px;padding:14px 16px;background:var(--bg-overlay);border:1px solid var(--border);border-radius:8px;cursor:pointer;transition:border-color .2s,background .2s;}
.project-item:hover{border-color:rgba(237,232,223,.4);background:rgba(237,232,223,.05);}
.project-icon{width:38px;height:38px;border-radius:8px;background:rgba(237,232,223,.08);border:1px solid rgba(237,232,223,.12);display:flex;align-items:center;justify-content:center;flex-shrink:0;color:var(--accent);}
.project-info{flex:1;min-width:0;}
.project-name{font-size:14px;font-weight:600;color:var(--text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.project-meta{font-size:12px;color:var(--text-muted);margin-top:2px;}
.project-badge{font-size:11px;padding:2px 8px;border-radius:99px;font-weight:500;flex-shrink:0;}
.badge-wip{background:rgba(240,136,62,.12);border:1px solid rgba(240,136,62,.3);color:var(--orange);}
.badge-done{background:rgba(237,232,223,.15);border:1px solid rgba(237,232,223,.35);color:#e87070;}
.badge-collab{background:rgba(188,140,255,.1);border:1px solid rgba(188,140,255,.3);color:var(--purple);}

.quick-actions{display:flex;flex-direction:column;gap:10px;}
.quick-action{display:flex;align-items:center;gap:12px;padding:14px 16px;background:var(--bg-overlay);border:1px solid var(--border);border-radius:8px;cursor:pointer;text-decoration:none;transition:border-color .2s,transform .2s;}
.quick-action:hover{border-color:rgba(237,232,223,.4);transform:translateX(4px);}
.qa-icon{width:36px;height:36px;border-radius:8px;background:rgba(237,232,223,.08);border:1px solid rgba(237,232,223,.12);display:flex;align-items:center;justify-content:center;flex-shrink:0;color:var(--accent);}
.qa-label{font-size:14px;font-weight:500;color:var(--text-primary);}
.qa-sub{font-size:12px;color:var(--text-muted);}
.qa-arrow{margin-left:auto;color:var(--text-muted);font-size:16px;}

.activity-feed{display:flex;flex-direction:column;gap:8px;margin-bottom:28px;}
.activity-item{display:flex;align-items:flex-start;gap:12px;padding:10px 14px;background:var(--bg-overlay);border:1px solid var(--border);border-radius:8px;}
.activity-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;margin-top:5px;}
.dot-red{background:var(--accent);}
.dot-orange{background:var(--orange);}
.dot-purple{background:var(--purple);}
.dot-muted{background:var(--text-muted);}
.activity-text{font-size:13px;color:var(--text-secondary);line-height:1.4;}
.activity-text strong{color:var(--text-primary);}
.activity-time{margin-left:auto;font-size:11px;color:var(--text-muted);white-space:nowrap;padding-top:2px;}

.trending-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;}
.beat-card{background:var(--bg-overlay);border:1px solid var(--border);border-radius:10px;overflow:hidden;cursor:pointer;transition:border-color .2s,transform .2s;}
.beat-card:hover{border-color:rgba(237,232,223,.45);transform:translateY(-3px);}
.beat-art{height:100px;background:var(--bg-inset);display:flex;align-items:center;justify-content:center;position:relative;}
.beat-play-btn{position:absolute;bottom:8px;right:8px;width:28px;height:28px;border-radius:50%;background:var(--accent);display:flex;align-items:center;justify-content:center;font-size:12px;opacity:0;transition:opacity .2s;}
.beat-card:hover .beat-play-btn{opacity:1;}
.beat-info{padding:12px 14px;}
.beat-name{font-size:13px;font-weight:600;color:var(--text-primary);margin-bottom:3px;}
.beat-artist{font-size:12px;color:var(--text-muted);}
.beat-tags{display:flex;gap:6px;margin-top:8px;flex-wrap:wrap;}
.tag{display:inline-flex;padding:2px 8px;background:rgba(237,232,223,.12);border:1px solid rgba(237,232,223,.3);border-radius:99px;font-size:11px;color:var(--accent);}

@media(max-width:900px){.two-col{grid-template-columns:1fr;}.stats-row{grid-template-columns:repeat(2,1fr);}}
@media(max-width:600px){.stats-row{grid-template-columns:1fr 1fr;}.welcome-banner{flex-direction:column;align-items:flex-start;}}
</style>
</head>
<body>

<div id="nav-root"></div>

<main class="page">

<div class="welcome-banner">
<div class="welcome-text">
<h1 id="welcome-heading">Welcome back</h1>
<p class="welcome-subtext">Here&#39;s what&#39;s happening with your music today.</p>
</div>
<div class="welcome-actions">
<a href="studio.html" class="btn btn-green">Open Studio</a>
<a href="explore.html" class="btn btn-ghost">Browse Beats</a>
</div>
</div>

<div class="stats-row">
<div class="stat-card">
<div class="stat-value" id="stat-beats">&#8212;</div>
<div class="stat-label">Beats Created</div>
</div>
<div class="stat-card">
<div class="stat-value" id="stat-projects">&#8212;</div>
<div class="stat-label">Projects</div>
</div>
<div class="stat-card">
<div class="stat-value" id="stat-plays">&#8212;</div>
<div class="stat-label">Total Plays</div>
</div>
<div class="stat-card">
<div class="stat-value" id="stat-collabs">&#8212;</div>
<div class="stat-label">Collaborations</div>
</div>
</div>

<div class="two-col">

<div>
<div class="section-header">
<span class="section-title">Recent Projects</span>
<a href="projects.html" class="section-link">View all &#8594;</a>
</div>
<div class="project-list" id="project-list"></div>
</div>

<div>
<div class="section-header">
<span class="section-title">Quick Actions</span>
</div>
<div class="quick-actions">
<a href="studio.html" class="quick-action">
<div class="qa-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg></div>
<div><div class="qa-label">Open Studio</div><div class="qa-sub">Create a new beat</div></div>
<span class="qa-arrow">&#8250;</span>
</a>
<a href="repo.html" class="quick-action">
<div class="qa-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/><line x1="12" y1="11" x2="12" y2="17"/><line x1="9" y1="14" x2="15" y2="14"/></svg></div>
<div><div class="qa-label">Beat Repository</div><div class="qa-sub">Browse your saved beats</div></div>
<span class="qa-arrow">&#8250;</span>
</a>
<a href="explore.html" class="quick-action">
<div class="qa-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></div>
<div><div class="qa-label">Explore Melodyfy</div><div class="qa-sub">Discover beats &amp; artists</div></div>
<span class="qa-arrow">&#8250;</span>
</a>
<a href="community.html" class="quick-action">
<div class="qa-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></div>
<div><div class="qa-label">Community</div><div class="qa-sub">Connect with producers</div></div>
<span class="qa-arrow">&#8250;</span>
</a>
<a href="settings.html" class="quick-action">
<div class="qa-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg></div>
<div><div class="qa-label">Settings</div><div class="qa-sub">Profile &amp; preferences</div></div>
<span class="qa-arrow">&#8250;</span>
</a>
</div>
</div>
</div>

<div>
<div class="section-header">
<span class="section-title">Recent Activity</span>
<a href="community.html" class="section-link">See more &#8594;</a>
</div>
<div class="activity-feed" id="activity-feed"></div>
</div>

<div style="margin-top:28px;">
<div class="section-header">
<span class="section-title">Trending on Melodyfy</span>
<a href="explore.html" class="section-link">Explore all &#8594;</a>
</div>
<div class="trending-grid" id="trending-grid"></div>
</div>

</main>

<script>
function getUser(){try{const t=localStorage.getItem('bf_token');if(!t)return null;return JSON.parse(atob(t.split('.')[1]));}catch{return null;}}
function signOut(){localStorage.removeItem('bf_token');location.href='index.html';}

function setGreeting(){
  const user=getUser();
  const name=user&&(user.username||user.email&&user.email.split('@')[0])||'Producer';
  const h=new Date().getHours();
  const g=h<12?'Good morning':h<18?'Good afternoon':'Good evening';
  document.getElementById('welcome-heading').textContent=g+', '+name;
}

function loadStats(){
  const projects=JSON.parse(localStorage.getItem('mfy_projects')||'[]');
  const beats=JSON.parse(localStorage.getItem('mfy_beats')||'[]');
  document.getElementById('stat-beats').textContent=beats.length||12;
  document.getElementById('stat-projects').textContent=projects.length||4;
  document.getElementById('stat-plays').textContent=JSON.parse(localStorage.getItem('mfy_plays')||'null')||'1.4k';
  document.getElementById('stat-collabs').textContent=JSON.parse(localStorage.getItem('mfy_collabs')||'null')||3;
}

const DEMO_PROJECTS=[
  {name:'Midnight Drive', bpm:93, key:'Dm', updated:'2h ago', badge:'wip'},
  {name:'Trap Season Vol.2', bpm:140, key:'Fm', updated:'Yesterday', badge:'collab'},
  {name:'Lo-Fi Vibes EP', bpm:78, key:'Cm', updated:'3 days ago',badge:'done'},
  {name:'808 Patterns', bpm:120, key:'Am', updated:'1 week ago',badge:'wip'},
];
const BADGE_LABEL={wip:'In Progress',done:'Released',collab:'Collab'};

function loadProjects(){
  const stored=JSON.parse(localStorage.getItem('mfy_projects')||'[]');
  const display=stored.length?stored.slice(0,4):DEMO_PROJECTS;
  document.getElementById('project-list').innerHTML=display.map(p=>`
<div class="project-item" onclick="location.href='studio.html'">
<div class="project-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg></div>
<div class="project-info">
<div class="project-name">${p.name}</div>
<div class="project-meta">${p.bpm} BPM &middot; ${p.key} &middot; ${p.updated}</div>
</div>
<span class="project-badge badge-${p.badge}">${BADGE_LABEL[p.badge]||p.badge}</span>
</div>`).join('');
}

const DEMO_ACTIVITY=[
  {dot:'dot-red', text:'<strong>You</strong> created a new beat &mdash;<strong>Midnight Drive</strong>',time:'2h ago'},
  {dot:'dot-purple', text:'<strong>BeatMaker_KJ</strong> forked your project<strong>Lo-Fi Vibes EP</strong>',time:'5h ago'},
  {dot:'dot-orange', text:'<strong>You</strong> pushed 3 new stem versions to<strong>Trap Season Vol.2</strong>',time:'Yesterday'},
  {dot:'dot-red', text:'<strong>SoundWave_22</strong> starred your beat<strong>808 Patterns</strong>',time:'2 days ago'},
  {dot:'dot-muted', text:'<strong>You</strong> updated BPM on<strong>Lo-Fi Vibes EP</strong> from 75 \u2192 78',time:'3 days ago'},
];

function loadActivity(){
  document.getElementById('activity-feed').innerHTML=DEMO_ACTIVITY.map(a=>`
<div class="activity-item">
<div class="activity-dot ${a.dot}"></div>
<div class="activity-text">${a.text}</div>
<div class="activity-time">${a.time}</div>
</div>`).join('');
}

const DEMO_TRENDING=[
  {name:'Drill Night', artist:'ProdByDark', tags:['Drill','140 BPM']},
  {name:'Golden Era Type', artist:'OldSchoolFlo', tags:['Hip-Hop','90s']},
  {name:'Afrobeats Summer',artist:'Vibez_GH', tags:['Afro','103 BPM']},
  {name:'Cloud Trap', artist:'AethericMc', tags:['Trap','Lo-Fi']},
  {name:'UK Garage Swing', artist:'LondonGrid', tags:['Garage','130BPM']},
];

function loadTrending(){
  document.getElementById('trending-grid').innerHTML=DEMO_TRENDING.map(b=>`
<div class="beat-card" onclick="location.href='explore.html'">
<div class="beat-art"><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="rgba(237,232,223,0.25)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg><div class="beat-play-btn">\u25B6</div></div>
<div class="beat-info">
<div class="beat-name">${b.name}</div>
<div class="beat-artist">by ${b.artist}</div>
<div class="beat-tags">${b.tags.map(t=>`<span class="tag">${t}</span>`).join('')}</div>
</div>
</div>`).join('');
}

document.addEventListener('DOMContentLoaded',()=>{
  setGreeting();loadStats();loadProjects();loadActivity();loadTrending();
});
</script>
<script src="nav.js"></script>
</body>
</html>